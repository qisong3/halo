(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9594f996"],{"12de":function(t,e,n){"use strict";var a=n("9efd"),o="/api/admin/themes",c={listAll:function(){return Object(a["a"])({url:"".concat(o),method:"get"})},listFilesActivated:function(){return Object(a["a"])({url:"".concat(o,"/activation/files"),method:"get"})},listFiles:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/files"),method:"get"})},customSheetTpls:function(){return Object(a["a"])({url:"".concat(o,"/activation/template/custom/sheet"),method:"get"})},customPostTpls:function(){return Object(a["a"])({url:"".concat(o,"/activation/template/custom/post"),method:"get"})},active:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/activation"),method:"post"})},getActivatedTheme:function(){return Object(a["a"])({url:"".concat(o,"/activation"),method:"get"})},update:function(t){return Object(a["a"])({url:"".concat(o,"/fetching/").concat(t),timeout:6e4,method:"put"})},delete:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t),method:"delete"})},fetchConfiguration:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/configurations"),method:"get"})},fetchSettings:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/settings"),method:"get"})},saveSettings:function(t,e){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/settings"),data:e,method:"post"})},getProperty:function(t){return Object(a["a"])({url:"".concat(o,"/").concat(t),method:"get"})},upload:function(t,e,n){return Object(a["a"])({url:"".concat(o,"/upload"),timeout:864e5,data:t,onUploadProgress:e,cancelToken:n,method:"post"})},updateByUpload:function(t,e,n,c){return Object(a["a"])({url:"".concat(o,"/upload/").concat(c),timeout:864e5,data:t,onUploadProgress:e,cancelToken:n,method:"put"})},fetching:function(t){return Object(a["a"])({url:"".concat(o,"/fetching"),timeout:6e4,params:{uri:t},method:"post"})},getContent:function(t){return Object(a["a"])({url:"".concat(o,"/files/content"),params:{path:t},method:"get"})}};c.getContent=function(t,e){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/files/content"),params:{path:e},method:"get"})},c.saveContent=function(t,e){return Object(a["a"])({url:"".concat(o,"/files/content"),data:{path:t,content:e},method:"put"})},c.saveContent=function(t,e,n){return Object(a["a"])({url:"".concat(o,"/").concat(t,"/files/content"),data:{path:e,content:n},method:"put"})},c.reload=function(){return Object(a["a"])({url:"".concat(o,"/reload"),method:"post"})},c.exists=function(t){return Object(a["a"])({url:"".concat(o,"/activation/template/exists"),method:"get",params:{template:t}})},e["a"]=c},"33c9":function(t,e,n){"use strict";n.r(e);var a,o,c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-row",{attrs:{gutter:12}},[n("a-col",{style:{"padding-bottom":"12px"},attrs:{xl:18,lg:18,md:18,sm:24,xs:24}},[n("a-card",{attrs:{bodyStyle:{padding:"16px"}}},[n("a-form",{attrs:{layout:"vertical"}},[n("a-form-item",[n("codemirror",{attrs:{options:t.codemirrorOptions},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("a-form-item",[n("a-button",{attrs:{type:"primary",disabled:t.buttonDisabled},on:{click:t.handlerSaveContent}},[t._v("保存")])],1)],1)],1)],1),n("a-col",{style:{"padding-bottom":"12px"},attrs:{xl:6,lg:6,md:6,sm:24,xs:24}},[n("a-card",{attrs:{bodyStyle:{padding:"16px"}}},[n("template",{slot:"title"},[n("a-select",{staticStyle:{width:"100%"},on:{change:t.onSelectTheme},model:{value:t.selectedTheme.id,callback:function(e){t.$set(t.selectedTheme,"id",e)},expression:"selectedTheme.id"}},t._l(t.themes,(function(e,a){return n("a-select-option",{key:a,attrs:{value:e.id}},[t._v(t._s(e.name)+" "),e.activated?n("a-icon",{attrs:{type:"check"}}):t._e()],1)})),1)],1),t.files?n("theme-file",{attrs:{files:t.files},on:{listenToSelect:t.handleSelectFile}}):t._e()],2)],1)],1)],1)},i=[],l=(n("7f7f"),n("12de")),r={name:"ThemeFile",props:{files:{type:Array,required:!1,default:function(){return[]}}},methods:{handleSelectFile:function(t){this.$emit("listenToSelect",t)},renderNode:function(t,e){var n=this,a=this;return e.node&&e.node.length?t("a-tree-node",{props:{key:e.path,title:e.name,isLeaf:e.isFile}},e.node.map((function(e){return n.renderNode(t,e)}))):t("a-tree-node",{props:{key:e.path,title:e.name,isLeaf:e.isFile},nativeOn:{click:function(){a.handleSelectFile(e)}}})}},render:function(t){var e=this;return this.files.length?t("a-directory-tree",this.files.map((function(n){return e.renderNode(t,n)}))):t("p","没有文件")}},s=r,u=n("2877"),d=Object(u["a"])(s,a,o,!1,null,null,null),h=d.exports,m=n("c884"),f=(n("d69f"),{components:{codemirror:m["codemirror"],ThemeFile:h},data:function(){return{buttonDisabled:!0,codemirrorOptions:{tabSize:4,mode:"text/html",lineNumbers:!0,line:!0},files:null,file:{},content:"",themes:[],selectedTheme:{}}},created:function(){this.loadActivatedTheme(),this.loadFiles(),this.loadThemes()},methods:{loadActivatedTheme:function(){var t=this;l["a"].getActivatedTheme().then((function(e){t.selectedTheme=e.data.data}))},loadFiles:function(){var t=this;l["a"].listFilesActivated().then((function(e){t.files=e.data.data}))},loadThemes:function(){var t=this;l["a"].listAll().then((function(e){t.themes=e.data.data}))},onSelectTheme:function(t){var e=this;this.files=null,l["a"].listFiles(t).then((function(t){e.files=t.data.data}))},handleSelectFile:function(t){var e=this,n=this;if(!t.editable)return this.$message.info("该文件不支持修改！"),this.content="",this.file={},void(this.buttonDisabled=!0);"settings.yaml"!==t.name&&"settings.yml"!==t.name&&"theme.yaml"!==t.name&&"theme.yml"!==t.name||this.$confirm({title:"警告：请谨慎修改该配置文件",content:"修改之后可能会产生不可预料的问题！",onCancel:function(){n.content="",n.file={},n.buttonDisabled=!0}}),l["a"].getContent(this.selectedTheme.id,t.path).then((function(n){e.content=n.data.data,e.file=t,e.buttonDisabled=!1}))},handlerSaveContent:function(){var t=this;l["a"].saveContent(this.selectedTheme.id,this.file.path,this.content).then((function(e){t.$message.success("保存成功！")}))}}}),p=f,b=Object(u["a"])(p,c,i,!1,null,null,null);e["default"]=b.exports}}]);